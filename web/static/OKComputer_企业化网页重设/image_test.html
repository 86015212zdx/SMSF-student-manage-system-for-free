<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å›¾ç‰‡åŠ è½½æµ‹è¯•</title>
    <style>
        body {
            background: #1A202C;
            color: #E2E8F0;
            font-family: Arial, sans-serif;
            padding: 20px;
        }
        .test-container {
            max-width: 800px;
            margin: 0 auto;
        }
        .test-image {
            width: 100%;
            max-width: 400px;
            height: auto;
            border: 2px solid #38B2AC;
            border-radius: 8px;
            margin: 20px 0;
        }
        .test-result {
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            font-family: monospace;
        }
        .success {
            background: rgba(72, 187, 120, 0.2);
            border: 1px solid #48BB78;
            color: #48BB78;
        }
        .error {
            background: rgba(245, 101, 101, 0.2);
            border: 1px solid #F56565;
            color: #F56565;
        }
        .info {
            background: rgba(56, 178, 172, 0.2);
            border: 1px solid #38B2AC;
            color: #38B2AC;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>å›¾ç‰‡åŠ è½½æµ‹è¯•</h1>
        
        <div class="test-result info">
            <strong>æµ‹è¯•æ—¶é—´:</strong> <span id="testTime"></span><br>
            <strong>å½“å‰URL:</strong> <span id="currentUrl"></span>
        </div>
        
        <h2>æµ‹è¯•å›¾ç‰‡ 1: The shape of time.jpg</h2>
        <img id="testImage1" class="test-image" src="/static/article_covers/The%20shape%20of%20time.jpg" alt="æµ‹è¯•å›¾ç‰‡1" onerror="handleImageError(this, 'testImage1')" onload="handleImageLoad(this, 'testImage1')">
        <div id="result1" class="test-result"></div>
        
        <h2>æµ‹è¯•å›¾ç‰‡ 2: Can you rewire your brain_.jpg</h2>
        <img id="testImage2" class="test-image" src="/static/article_covers/Can%20you%20rewire%20your%20brain_.jpg" alt="æµ‹è¯•å›¾ç‰‡2" onerror="handleImageError(this, 'testImage2')" onload="handleImageLoad(this, 'testImage2')">
        <div id="result2" class="test-result"></div>
        
        <h2>æµ‹è¯•å›¾ç‰‡ 3: Compost modernity!.jpg</h2>
        <img id="testImage3" class="test-image" src="/static/article_covers/Compost%20modernity!.jpg" alt="æµ‹è¯•å›¾ç‰‡3" onerror="handleImageError(this, 'testImage3')" onload="handleImageLoad(this, 'testImage3')">
        <div id="result3" class="test-result"></div>
        
        <button onclick="reloadImages()" style="padding: 10px 20px; background: #38B2AC; color: #1A202C; border: none; border-radius: 5px; cursor: pointer; margin-top: 20px;">
            é‡æ–°åŠ è½½æ‰€æœ‰å›¾ç‰‡
        </button>
    </div>

    <script>
        // åˆå§‹åŒ–é¡µé¢ä¿¡æ¯
        document.getElementById('testTime').textContent = new Date().toLocaleString();
        document.getElementById('currentUrl').textContent = window.location.href;
        
        // å›¾ç‰‡åŠ è½½æˆåŠŸå›è°ƒ
        function handleImageLoad(img, resultId) {
            const resultDiv = document.getElementById(resultId);
            resultDiv.className = 'test-result success';
            resultDiv.innerHTML = `
                <strong>âœ… å›¾ç‰‡åŠ è½½æˆåŠŸ</strong><br>
                å›¾ç‰‡å°ºå¯¸: ${img.naturalWidth} Ã— ${img.naturalHeight}<br>
                å®Œæ•´URL: ${img.src}<br>
                çŠ¶æ€: å·²åŠ è½½
            `;
        }
        
        // å›¾ç‰‡åŠ è½½å¤±è´¥å›è°ƒ
        function handleImageError(img, resultId) {
            const resultDiv = document.getElementById(resultId);
            resultDiv.className = 'test-result error';
            resultDiv.innerHTML = `
                <strong>âŒ å›¾ç‰‡åŠ è½½å¤±è´¥</strong><br>
                å°è¯•çš„URL: ${img.src}<br>
                é”™è¯¯ä¿¡æ¯: æ— æ³•åŠ è½½å›¾ç‰‡<br>
                çŠ¶æ€: åŠ è½½å¤±è´¥
            `;
        }
        
        // é‡æ–°åŠ è½½æ‰€æœ‰å›¾ç‰‡
        function reloadImages() {
            // æ¸…ç©ºç»“æœ
            document.querySelectorAll('.test-result[id^="result"]').forEach(el => {
                el.className = 'test-result info';
                el.innerHTML = '<strong>ğŸ”„ æ­£åœ¨é‡æ–°åŠ è½½...</strong>';
            });
            
            // é‡æ–°åŠ è½½å›¾ç‰‡
            document.querySelectorAll('img').forEach(img => {
                // æ·»åŠ æ—¶é—´æˆ³é˜²æ­¢ç¼“å­˜
                const url = new URL(img.src);
                url.searchParams.set('t', Date.now());
                img.src = url.toString();
            });
        }
        
        // é¡µé¢åŠ è½½å®Œæˆåæ£€æŸ¥å›¾ç‰‡çŠ¶æ€
        window.addEventListener('load', function() {
            console.log('é¡µé¢åŠ è½½å®Œæˆï¼Œæ£€æŸ¥å›¾ç‰‡çŠ¶æ€...');
            document.querySelectorAll('img').forEach((img, index) => {
                setTimeout(() => {
                    if (img.complete) {
                        if (img.naturalWidth > 0) {
                            handleImageLoad(img, `result${index + 1}`);
                        } else {
                            handleImageError(img, `result${index + 1}`);
                        }
                    }
                }, 100);
            });
        });
    </script>
</body>
</html>